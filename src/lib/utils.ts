import fs from "fs";

function getFiles(path = "./") {
  const entries = fs.readdirSync(path, { withFileTypes: true });

  // Get files within the current directory and add a path key to the file objects
  const files = entries
    .filter((file) => !file.isDirectory())
    .map((file) => ({ ...file, path: path + "/" + file.name }));

  // Get folders within the current directory
  const folders = entries.filter((folder) => folder.isDirectory());

  /*
          Add the found files within the subdirectory to the files array by calling the
          current function itself
        */
  for (const folder of folders)
    files.push(...getFiles(`${path}/${folder.name}`));

  return files;
}

export var files = {
  getFiles: getFiles,
};
