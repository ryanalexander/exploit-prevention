import Discord from 'discord.js';
import {Managers} from "./lib/libaries";
import {EventManager, CommandManager, GuildManager} from "./managers/Managers";
import DBL from "top.gg";
import SQL from "./lib/SQL";

const config = require("../config.json");

const client = new Discord.Client({ shards: "auto"});

// Global Managers
Managers.DiscordClient = client;
Managers.Config = config;

// Event Manager
Managers.EventManager = new EventManager("./events");

// Command Manager
Managers.CommandManager = new CommandManager("./commands");

// Guild Manager
Managers.GuildManager = new GuildManager(client);

import CrashDetection from "./lib/CrashDetection";
new CrashDetection("./");
// SQL Manager
Managers.SQL = new SQL();


if(!config.isDev) {
    // TopGG Integration
    const dbl = new DBL('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjgyMTcwMTgyMzYxNzgyNjg1NiIsImJvdCI6dHJ1ZSwiaWF0IjoxNjIxNDkzMjg0fQ.R12aUmqCfSBC_fe48iF28FJMxGttDBufhM8wzlFpcAg', client);
    dbl.on('posted', () => {
        console.log('Server count posted!');
    })
    dbl.on('error', e => {
        console.log(`Oops! ${e}`);
    })

    // discordbotlist.com Integration
}

//client.login(config.isDev?config.tokens.dev:config.tokens.production);