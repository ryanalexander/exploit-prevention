import Discord from "discord.js";
import { Managers } from "./lib/libaries";
import SQL from "./lib/SQL";
import {
  CommandManager,
  EventManager,
  GuildManager,
  ModuleManager,
  ScheduleManager,
  UserManager,
} from "./managers/Managers";
import FOIService from "./services/FOI.service";
import GlobalbanService from "./services/Globalban.service";
import StatsService from "./services/Stats.service";

const config = require("../config.json");

const client = new Discord.Client({
  shards: "auto",
  intents: [
    "GUILDS",
    "GUILD_MEMBERS",
    "GUILD_BANS",
    "GUILD_INVITES",
    "GUILD_MESSAGES",
    "GUILD_MESSAGE_REACTIONS",
    "GUILD_MESSAGE_TYPING",
  ],
});

// Global Managers
//Managers.RedisClient = asyncRedis.createClient(6379, "127.0.0.1", {});
Managers.DiscordClient = client;
Managers.Config = config;

// Event Manager
Managers.EventManager = new EventManager("./events");

// Command Manager
Managers.CommandManager = new CommandManager("./commands");

// Module Manager
Managers.ModuleManager = new ModuleManager("./modules");

// Guild Manager
Managers.GuildManager = new GuildManager(client);

// User Manager
Managers.UserManager = new UserManager(client);

// Schedule Manager idk
Managers.ScheduleManager = new ScheduleManager();

// SQL Manager
Managers.SQL = new SQL();

// Services

client
  .login(config.isDev ? config.tokens.dev : config.tokens.production)
  .then(() => {
    new StatsService();
    new GlobalbanService();
    new FOIService();
  });
