import {Command, Managers} from '../../lib/libaries';
import {Guild, GuildMember, Message, MessageEmbed} from 'discord.js';

module.exports = class extends Command {
    constructor() {
        super({
            name: "botstats",
            aliases: [],
            description: "View bot statistics",
            category: "dev"
        });
        this._execute = this.execute;
    }

    async execute(_member: GuildMember, _content: string, _message: Message) {
        let embed = new MessageEmbed();

        if(_member.user.id !== "317236321099710467") return;

        embed.addField("Total Guilds", Managers.DiscordClient.guilds.cache.size, true);
        embed.addField("Total Users", Managers.DiscordClient.users.cache.size, true);

        embed.addField("Sizes", "All the different size-brackets the servers are in", false)

        embed.addField("Large Guilds (>10k)", Managers.DiscordClient.guilds.cache.filter((guild:Guild) => guild.memberCount>10000).size, false)
        embed.addField("Med Guilds (>5 <10k)", Managers.DiscordClient.guilds.cache.filter((guild:Guild) => guild.memberCount>5000 && guild.memberCount < 10000).size, false)
        embed.addField("Small Guilds (<5k)", Managers.DiscordClient.guilds.cache.filter((guild:Guild) => guild.memberCount < 5000).size, false)

        if(_content.indexOf("-log") > -1) {
            console.log(JSON.stringify(Managers.DiscordClient.guilds.cache))
        }

        _message.channel.send(embed);
    };

}