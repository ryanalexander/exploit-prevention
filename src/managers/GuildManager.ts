import {Managers} from '../lib/libaries';
import {Guild, MessageEmbed, TextChannel} from "discord.js";

module.exports =class {
    constructor() {
    }

    async getGuildOrCreate(guild: Guild): Promise<{ snowflake: Number, log_channel: Number, prefix: string }> {
        let g = await Managers.SQL.getGuild(guild);
        if(!g) {
            await Managers.SQL.registerGuild(guild);
        }else {
            return g;
        }
        return await this.getGuildOrCreate(guild);
    }

    async setPrefix(guild: Guild, prefix: String) {
        await Managers.SQL.setPrefix(guild, prefix);
    }

    async setLogs(guild: Guild, channel: TextChannel | undefined) {
        if(channel!=undefined)
            channel.send(new MessageEmbed().addField("Logs channel set","I will now post all detection logs into this channel."))
        await Managers.SQL.setLogs(guild, channel != undefined ? Number(channel.id) : 0);
    }

    async setAction(guild: Guild, action: Number) {
        await Managers.SQL.setAction(guild, action);
    }
}