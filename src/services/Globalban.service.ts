import { Managers } from "../lib/libaries";

export default class {
  last_check: any;

  constructor() {
    // Loop to kick people from servers
    // Loop to issue global bans? Maybe in infraction module
    this.last_check = new Date();
    setInterval(() => this.doBanLoop(), 5000);
  }

  async doBanLoop() {
    // QUERY GLOBAL BANLIST WHERE ENTERED SINCE LAST CHECK
    // @ts-ignore
    let bans = await Managers.SQL.getScheduledBans(
      this.last_check,
      Number(new Date())
    );
    this.last_check = new Date();

    //await Managers.SQL.addGlobalBan({ id: 317236321099710467 }, "testing");
    // QUERY GUILD MEMBERS FOR MUTUAL GUILDS

    let guilds = await Managers.UserManager.getMutualGuilds(
      "286422084043931658"
    );
    console.log(guilds);
    // LOOP THROUGH MANAGED SERVERS WITH MEMBER AND MODULE ENABLED
    // SEND MESSAGE IN EXP CHANNEL TAGGING ALERT ROLE
    // TODO BAN ONCE DETERMINED TO BE STABLE
  }
}
